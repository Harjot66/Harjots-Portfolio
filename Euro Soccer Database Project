-- To determine the team's chancecreationshooting by team where average chancecreationshooting is more than or equal to 60

SELECT team.team_long_name, team_attributes.chancecreationshooting
FROM team LEFT JOIN team_attributes ON team_attributes.team_api_id = team.team_api_id
WHERE team_attributes.chancecreationshooting >= 60
GROUP BY team.team_long_name;

-- To determine the number of matches by country and show the top5 countries with most number of matches

SELECT country.name AS country_name, COUNT(DISTINCT(matches.id)) AS num_matches
FROM country LEFT JOIN League ON league.country_id = country.id
			LEFT JOIN Matches ON matches.league_id = league.id
GROUP BY country.name
ORDER BY num_matches DESC
LIMIT 5;

-- To determine the players whose volley rating is equal to 75

SELECT player.player_name, player_attributes.volleys
FROM player LEFT JOIN player_attributes ON player.id = player_attributes.id
WHERE player_attributes.volleys = 75

-- To delete Spain from the list of countries

SELECT id FROM Country WHERE name = 'Spain';

DELETE FROM Country
WHERE id = 2;

-- To insert a new player into the Player table

INSERT INTO Player (id, player_api_id, player_name, player_fifa_api_id, birthday, height, weight)
VALUES (1054, '985432', "Harry Williams", '527498', '1975-06-25 00:00:00', '178', '164');
